# Pre-commit hooks for Feiqiu Communication
# Tech Stack: Tauri 2.0 + Rust + React + TypeScript
# Note: Hooks run in order. Type check runs before formatting to avoid conflicts.

repos:
  # ========== Frontend (TypeScript/React) ==========

  # TypeScript type check (runs first - checks staged files before formatting)
  - repo: local
    hooks:
      - id: tsc
        name: TypeScript type check
        entry: bunx tsc --noEmit
        language: system
        types: [file]
        files: \.(ts|tsx)$
        pass_filenames: false

  # ESLint - Linting (uses local project version)
  # - repo: local
  #   hooks:
  #     - id: eslint
  #       name: ESLint
  #       entry: bunx eslint --fix
  #       language: system
  #       types: [file]
  #       files: \.(js|ts|tsx|jsx)$
  #       exclude: |
  #         (?x)^(
  #           node_modules/.*|
  #           dist/.*
  #         )$

  # Stylelint - CSS/Less linting
  - repo: local
    hooks:
      - id: stylelint
        name: Stylelint
        entry: bunx stylelint --fix
        language: system
        types: [file]
        files: \.(css|less)$
        exclude: |
          (?x)^(
            node_modules/.*|
            dist/.*
          )$

  # Prettier - Code formatting (runs last, may modify files)
  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v3.0.3
    hooks:
      - id: prettier
        types: [file]
        files: \.(js|ts|tsx|jsx|json|css|scss|md)$

  # ========== Backend (Rust) ==========

  # Rust formatting
  - repo: local
    hooks:
      - id: cargo-fmt
        name: Cargo fmt
        entry: cargo +nightly fmt
        language: system
        types: [rust]
        pass_filenames: false

  # # Clippy - Rust linter
  # - repo: local
  #   hooks:
  #     - id: clippy
  #       name: Clippy
  #       entry: cargo clippy --all-targets -- -D warnings
  #       language: system
  #       types: [rust]
  #       pass_filenames: false

  # Cargo check - Compile verification
  - repo: local
    hooks:
      - id: cargo-check
        name: Cargo check
        entry: cargo check
        language: system
        types: [rust]
        pass_filenames: false
